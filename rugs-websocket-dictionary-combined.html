<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rugs.fun WebSocket Dictionary v1.0</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --dark-color: #34495e;
            --light-color: #ecf0f1;
            --code-bg: #2d3436;
            --code-color: #74b9ff;
            --border-color: #bdc3c7;
            --section-bg: #f8f9fa;
            --verified-color: #27ae60;
            --partial-color: #f39c12;
            --table-alt-bg: #f5f6fa;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }

        .container {
            display: flex;
            width: 100%;
            height: 100vh;
        }

        .sidebar {
            width: 280px;
            background-color: var(--dark-color);
            color: white;
            padding: 20px 0;
            overflow-y: auto;
            position: fixed;
            height: 100vh;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        .content {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
            max-width: calc(100% - 280px);
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }

        .sidebar-header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .nav-section {
            margin-bottom: 15px;
        }

        .nav-section-title {
            padding: 10px 20px;
            font-weight: bold;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }

        .nav-items {
            list-style: none;
        }

        .nav-item {
            padding: 8px 20px 8px 30px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background-color: var(--primary-color);
            border-left: 3px solid var(--light-color);
        }

        .section {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        h1, h2, h3, h4 {
            color: var(--dark-color);
            margin-bottom: 20px;
        }

        h1 { /* Document Title */
            font-size: 2.2rem; /* Slightly smaller for document title if needed */
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        h2 { /* Main Section Titles (1., 2., 3.) */
            font-size: 1.8rem;
            margin-top: 40px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }

        h3 { /* Sub-Section Titles (3.1, 3.1.1) */
            font-size: 1.5rem;
            margin-top: 30px;
            color: var(--primary-color);
        }
        
        h4 { /* Event Card Titles / Further sub-headings */
            font-size: 1.3rem; /* Adjusted for event card titles */
            margin-top: 0; /* Reset for use in event-card */
            margin-bottom: 15px;
            color: var(--dark-color);
        }


        p {
            margin-bottom: 15px;
        }

        ul, ol {
            margin-bottom: 20px;
            padding-left: 25px;
        }

        li {
            margin-bottom: 5px;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            background-color: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.9em;
            color: var(--accent-color);
        }

        pre {
            background-color: var(--code-bg);
            color: var(--code-color);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto; /* Ensures horizontal scrollbar for wide content */
            margin-bottom: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            position: relative;
            max-width: 100%; /* ADDED: Constrain pre element's max width */
            box-sizing: border-box; /* ADDED: Ensure padding doesn't add to width causing overflow */
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            border-radius: 0;
            font-size: 0.9rem;
            color: #f8f9fa; /* Light color for text on dark background */
            display: block; /* ADDED: Make it a block to help with width containment */
            overflow-wrap: break-word; /* ADDED: Break long words/strings if they would overflow */
            white-space: pre-wrap; /* ADDED: Allow wrapping while preserving whitespace sequences. Works with overflow-x. */
        }
        
        /* Language-specific styling for "javascript" in pre tags */
        pre code.language-javascript {
            color: #74b9ff; /* Default inherited color */
        }
        pre code.language-json {
             color: #f8f9fa; /* Light color for text on dark background */
        }
         pre code.language-csv {
             color: #f8f9fa; /* Light color for text on dark background */
        }


        .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(255,255,255,0.1);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background-color 0.2s;
        }

        .copy-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--dark-color);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--table-alt-bg);
        }

        .tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 5px;
        }

        .tag-verified {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--verified-color);
            border: 1px solid var(--verified-color);
        }

        .tag-partial {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--partial-color);
            border: 1px solid var(--partial-color);
        }

        .important-note {
            background-color: rgba(231, 76, 60, 0.1);
            border-left: 4px solid var(--accent-color);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 3px;
        }

        .important-note h4 { /* Title within important-note */
            color: var(--accent-color);
            font-size: 1.2rem; /* Match general h4 */
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .event-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary-color);
        }

        .event-title { /* Container for h4 and frequency tag */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .event-title h4 { /* Titles like gameStateUpdate, tradeEvent inside cards */
            margin:0; /* Already handled by general h4, but ensure no extra margin */
        }

        .frequency-tag {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: bold;
            white-space: nowrap;
        }

        .frequency-high { background-color: rgba(231, 76, 60, 0.2); color: #e74c3c; }
        .frequency-medium { background-color: rgba(243, 156, 18, 0.2); color: #f39c12; }
        .frequency-low { background-color: rgba(46, 204, 113, 0.2); color: #2ecc71; }

        .event-description {
            margin-bottom: 15px;
        }
        
        .event-details ul {
            padding-left: 20px; /* Indent lists within event cards */
            margin-bottom: 10px;
        }
        .event-details ul li {
            margin-bottom: 3px;
        }
        .event-details strong {
            color: var(--dark-color);
        }

        .toggle-btn {
            display: inline-block;
            padding: 5px 10px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 1024px) {
            .sidebar { width: 220px; }
            .content { margin-left: 220px; max-width: calc(100% - 220px); }
        }

        @media (max-width: 768px) {
            .container { flex-direction: column; height: auto; }
            .sidebar { width: 100%; height: auto; position: relative; padding: 10px; box-shadow: none; }
            .content { margin-left: 0; max-width: 100%; padding: 15px; height: auto; }
            .sidebar-header { text-align: center;}
            .nav-section-title { text-align: center;}
            .nav-item { padding: 10px 20px; text-align: center;}
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>Rugs.fun WebSocket</h1>
                <p>Complete Dictionary v1.0</p>
            </div>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search events, fields...">
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Document Sections</div>
                <ul class="nav-items">
                    <li class="nav-item active" onclick="scrollToSection('document-introduction')">Introduction</li>
                    <li class="nav-item" onclick="scrollToSection('game-parameters')">1. Game Parameters</li>
                    <li class="nav-item" onclick="scrollToSection('game-state-machine')">2. Game State Machine</li>
                    <li class="nav-item" onclick="scrollToSection('websocket-events')">3. WebSocket Events</li>
                    <li class="nav-item" onclick="scrollToSection('data-fields-reference')">4. Data Fields Reference</li>
                    <li class="nav-item" onclick="scrollToSection('event-relationships')">5. Event Relationships</li>
                    <li class="nav-item" onclick="scrollToSection('verification-status')">6. Verification Status</li>
                    <li class="nav-item" onclick="scrollToSection('example-payloads')">7. Example Payloads</li>
                </ul>
            </div>
        </div>
        
        <div class="content">
            <section id="document-introduction" class="section">
                <h1>Rugs.fun WebSocket Dictionary</h1>
                <p><strong>Last Updated:</strong> May 11, 2025</p>
                
                <div class="important-note">
                    <h4>Important God Candle Note</h4>
                    <p>Analysis of 6 rounds with 263 crash events revealed 5 God Candle events that increased price from extremely low values (0.007-0.02) back to 1.0 during active games. These events are technically God Candles (>10x price jumps) but occur after significant price drops, creating an artificial "reset" effect rather than genuine price spikes during normal gameplay. This may be a marketing tactic to claim higher God Candle frequency.</p>
                </div>

                <p><strong>Latest Addition:</strong> The crate reward system (crateInfo event) has been documented, providing details on the game's progression and reward mechanics outside the main gameplay loop.</p>
                
                <h3>Overview</h3>
                <p>This document provides a comprehensive catalog of WebSocket events, fields, and relationships for the Rugs.fun game platform. It serves as the definitive reference for understanding the game's communication protocol and data structures.</p>
                
                <h3>Contents</h3>
                <ul>
                    <li><a href="#" onclick="scrollToSection('game-parameters'); return false;">1. Game Parameters</a></li>
                    <li><a href="#" onclick="scrollToSection('game-state-machine'); return false;">2. Game State Machine</a></li>
                    <li><a href="#" onclick="scrollToSection('websocket-events'); return false;">3. WebSocket Events</a></li>
                    <li><a href="#" onclick="scrollToSection('data-fields-reference'); return false;">4. Data Fields Reference</a></li>
                    <li><a href="#" onclick="scrollToSection('event-relationships'); return false;">5. Event Relationships</a></li>
                    <li><a href="#" onclick="scrollToSection('verification-status'); return false;">6. Verification Status</a></li>
                    <li><a href="#" onclick="scrollToSection('example-payloads'); return false;">7. Example Payloads</a></li>
                </ul>
            </section>

            <section id="game-parameters" class="section">
                <h2>1. Game Parameters</h2>
                <p>These constants define the core mechanics of the game.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Description</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>RUG_PROB</code></td>
                            <td>0.005 (0.5%)</td>
                            <td>Probability per tick of game termination</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>GOD_CANDLE_CHANCE</code></td>
                            <td>0.00001 (0.001%)</td>
                            <td>Probability per tick of significant price jump</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>GOD_CANDLE_MOVE</code></td>
                            <td>Variable</td>
                            <td>Typically brings price back to 1.0 after significant drops</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>BIG_MOVE_CHANCE</code></td>
                            <td>0.125 (12.5%)</td>
                            <td>Probability per tick of significant price movement</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>BIG_MOVE_MIN</code></td>
                            <td>0.15</td>
                            <td>Minimum size of a big move (15%)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>BIG_MOVE_MAX</code></td>
                            <td>0.25</td>
                            <td>Maximum size of a big move (25%)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>DRIFT_MIN</code></td>
                            <td>-0.02</td>
                            <td>Minimum drift per tick (-2%)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>DRIFT_MAX</code></td>
                            <td>0.03</td>
                            <td>Maximum drift per tick (+3%)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>TICKS_PER_CANDLE</code></td>
                            <td>5</td>
                            <td>Number of price updates per visual candle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>TICK_MS</code></td>
                            <td>250</td>
                            <td>Milliseconds per tick</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>MAX_BET_SOL</code></td>
                            <td>5</td>
                            <td>Maximum bet amount allowed</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>MIN_VALID_TICKS</code></td>
                            <td>20</td>
                            <td>Minimum ticks for valid game</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>TRADE_FEE</code></td>
                            <td>0</td>
                            <td>Trading fee percentage</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>MAX_TICKS</code></td>
                            <td>5000</td>
                            <td>Maximum ticks per game</td>
                            <td><span class="tag tag-partial">⚠️ PARTIALLY VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>PRESALE_DURATION</code></td>
                            <td>10s</td>
                            <td>Duration of initial buying phase</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>COOLDOWN_DURATION</code></td>
                            <td>~15s</td>
                            <td>Time between games</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section id="game-state-machine" class="section">
                <h2>2. Game State Machine</h2>
                <p>The game progresses through four main phases in a predictable sequence.</p>
                <h3>Phase Sequence</h3>
                <h4>1. Presale Phase</h4>
                <ul>
                    <li><strong>Duration:</strong> 10 seconds</li>
                    <li><strong>Starting Price:</strong> 1.0x multiplier (fixed)</li>
                    <li><strong>Player Actions:</strong> Buy only (no price movement)</li>
                    <li><strong>Event Indicators:</strong> <code>phase: "presale"</code>, <code>active: false</code>, <code>allowPreRoundBuys: true</code></li>
                    <li><strong>State Transition:</strong> Automatic after 10 seconds</li>
                </ul>
                <h4>2. Active Phase</h4>
                <ul>
                    <li><strong>Duration:</strong> Variable (0.25s - 125s, max 5000 ticks)</li>
                    <li><strong>Tick Frequency:</strong> 4 ticks per second (250ms per tick)</li>
                    <li><strong>Player Actions:</strong> Buy and sell allowed</li>
                    <li><strong>Event Indicators:</strong> <code>phase: "active"</code>, <code>active: true</code></li>
                    <li><strong>State Transition:</strong> Occurs on rug event or maximum ticks reached</li>
                </ul>
                <h4>3. Settlement Phase</h4>
                <ul>
                    <li><strong>Duration:</strong> Instant</li>
                    <li><strong>Event Indicators:</strong> <code>phase: "settlement"</code>, <code>active: false</code>, <code>rugged: true</code></li>
                    <li><strong>Actions:</strong> Force liquidation of all positions</li>
                    <li><strong>Liquidation Values:</strong> 0.007695x to 0.02x (observed range)</li>
                    <li><strong>State Transition:</strong> Immediate to cooldown</li>
                </ul>
                <h4>4. Cooldown Phase</h4>
                <ul>
                    <li><strong>Duration:</strong> ~15 seconds</li>
                    <li><strong>Event Indicators:</strong> <code>phase: "cooldown"</code>, <code>active: false</code>, <code>cooldownTimer: [countdown value]</code></li>
                    <li><strong>Player Actions:</strong> None</li>
                    <li><strong>State Transition:</strong> Automatic to next game presale</li>
                </ul>
                <h3>Price Generation Algorithm</h3>
                <p>For each tick during the Active phase:</p>
                <ol>
                    <li><strong>Rug Check:</strong>
                        <ul>
                            <li>Generate random number</li>
                            <li>If &lt; <code>RUG_PROB</code> (0.5%), terminate game</li>
                        </ul>
                    </li>
                    <li><strong>God Candle Check:</strong>
                        <ul>
                            <li>If game continues, generate random number</li>
                            <li>If &lt; <code>GOD_CANDLE_CHANCE</code> (0.001%) AND current_price &lt;= 100, multiply price by a large factor</li>
                            <li><strong>Important Note:</strong> Observed data shows many "God Candles" occur after significant price drops (to 0.007-0.02 range), creating &gt;10x jumps back to 1.0 during active gameplay. This artificially inflates the apparent frequency of God Candle events while maintaining technical compliance with the "10x jump" definition.</li>
                        </ul>
                    </li>
                    <li><strong>Big Move Check:</strong>
                        <ul>
                            <li>If no god candle, generate random number</li>
                            <li>If &lt; <code>BIG_MOVE_CHANCE</code> (12.5%), apply move between <code>BIG_MOVE_MIN</code> and <code>BIG_MOVE_MAX</code> (15-25%)</li>
                            <li>Direction determined by coin flip (50/50)</li>
                        </ul>
                    </li>
                    <li><strong>Normal Drift:</strong>
                        <ul>
                            <li>If no big move, calculate:
                                <ul>
                                    <li>Base drift between <code>DRIFT_MIN</code> and <code>DRIFT_MAX</code> (-2% to +3%)</li>
                                    <li>Apply volatility factor: 0.005 * min(10, sqrt(price))</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ol>
            </section>

            <section id="websocket-events" class="section">
                <h2>3. WebSocket Events</h2>
                
                <h3>3.1 Raw WebSocket Events</h3>
                <p>These are the direct events received from the server.</p>

                <div class="event-card" id="gameStateUpdate-event">
                    <div class="event-title">
                        <h4>3.1.1 gameStateUpdate</h4>
                        <span class="frequency-tag frequency-high">High Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>This is the primary event containing comprehensive game state information, sent frequently to update clients.</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure:</strong>
                        <pre><code class="language-json">{
  "type": "gameStateUpdate",
  "data": {
    // Game state fields as detailed in section 4.1
  }
}</code></pre>
                        <strong>Key Data Fields:</strong>
                        <ul>
                            <li>Game status indicators (<code>active</code>, <code>rugged</code>, etc.)</li>
                            <li>Current price and tick information</li>
                            <li>Candle and trade data</li>
                            <li>Player information</li>
                            <li>Game parameters</li>
                        </ul>
                        <p><strong>Frequency:</strong> High (multiple times per second during active phase)</p>
                        <p><strong>Relationship:</strong> Parent event that contains most other data structures.</p>
                    </div>
                    <div class="toggle-btn" onclick="toggleSection('gameStateUpdate-example-payload')">View Example Payload</div>
                    <pre id="gameStateUpdate-example-payload" class="hidden"><button class="copy-btn" onclick="copyToClipboard('gameStateUpdate-example-payload-content')">Copy</button><code id="gameStateUpdate-example-payload-content" class="language-json">{
  "type": "gameStateUpdate",
  "data": {
    "active": true,
    "gameId": "20250511-9ead1cd8eb704197",
    "gameVersion": "v3",
    "tickCount": 47,
    "price": 1.3245678901234567,
    "rugged": false,
    "prngCallCount": 723,
    "cooldownTimer": 0,
    "averageMultiplier": 4.12,
    "connectedPlayers": 203,
    "allowPreRoundBuys": false,
    "cooldownPaused": false,
    "tradeCount": 24,
    "candles": [
      {
        "open": 1.0,
        "high": 1.05,
        "low": 0.98,
        "close": 1.03,
        "index": 0,
        "volume": 7.5
      },
      {
        "open": 1.03,
        "high": 1.12,
        "low": 1.01,
        "close": 1.09,
        "index": 1,
        "volume": 3.2
      }
    ],
    "currentCandle": {
      "open": 1.15,
      "high": 1.32,
      "low": 1.15,
      "close": 1.32,
      "index": 3,
      "volume": 4.3
    },
    "trades": [
      {
        "playerId": "did:privy:abc123def456ghi789jkl012",
        "username": "CryptoKing",
        "type": "buy",
        "price": 1.0,
        "qty": 0.05,
        "tickIndex": 0,
        "isPreRoundBuy": true,
        "cost": 0.05,
        "coinTicker": "SOL",
        "coinAddress": "SOL",
        "bonusPortion": 0,
        "realPortion": 0.05,
        "proceeds": null
      }
    ],
    "leaderboard": [
      {
        "id": "did:privy:abc123def456ghi789jkl012",
        "username": "CryptoKing",
        "level": 24,
        "pnl": 0.0453,
        "pnlPercent": 60.4,
        "position": 1,
        "positionQty": 0.075,
        "avgCost": 1.0,
        "totalInvested": 0.075,
        "hasActiveTrades": true,
        "selectedCoin": "SOL"
      }
    ],
    "gameHistory": [
      {
        "id": "20250511-8cfa54b7e21d3086",
        "peakMultiplier": 2.45,
        "rugged": true
      }
    ],
    "provablyFair": {
      "serverSeedHash": "1d78eeadf6ecf59ca0d8503d493eff0c2180be98bff95ad31a2bcb7ebfc4b43f",
      "version": "v3"
    },
    "BIG_MOVE_CHANCE": 0.125,
    "BIG_MOVE_MAX": 0.25,
    "BIG_MOVE_MIN": 0.15,
    "DRIFT_MAX": 0.03,
    "DRIFT_MIN": -0.02,
    "GOD_CANDLE_CHANCE": 0.00001,
    "MAX_BET_SOL": 5,
    "MIN_VALID_TICKS": 20,
    "RUG_PROB": 0.005,
    "TICKS_PER_CANDLE": 5,
    "TICK_MS": 250,
    "TRADE_FEE": 0
  }
}</code></pre>
                </div>

                <div class="event-card" id="tradeEvent-event">
                    <div class="event-title">
                        <h4>3.1.2 tradeEvent</h4>
                        <span class="frequency-tag frequency-medium">Medium Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>A specific event for individual trades that occur.</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure:</strong>
                        <pre><code class="language-json">{
  "type": "tradeEvent",
  "data": {
    // Trade data fields as detailed in section 4.3
  }
}</code></pre>
                        <strong>Key Data Fields:</strong>
                        <ul>
                            <li>Trade type (buy or sell)</li>
                            <li>Player identifier and username</li>
                            <li>Price, quantity, and tick index</li>
                        </ul>
                        <p><strong>Frequency:</strong> Medium (triggered by player actions)</p>
                        <p><strong>Relationship:</strong> Trade data also appears in the <code>trades</code> array of <code>gameStateUpdate</code>.</p>
                    </div>
                    <!-- Example payload for tradeEvent is in section 7.2 -->
                </div>

                <div class="event-card" id="crateInfo-event">
                    <div class="event-title">
                        <h4>3.1.3 crateInfo</h4>
                        <span class="frequency-tag frequency-low">Low Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>Event containing information about the reward crate system.</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure:</strong>
                        <pre><code class="language-json">{
  "type": "crateInfo",
  "data": {
    "crates": {
      "tier0": { /* Iron Crate data */ },
      "tier1": { /* Bronze Crate data */ },
      // ... more tiers
      "referral": { /* Referral Crate data */ }
    },
    "userCrates": {
      // User's specific crate data as detailed in section 4.x (Crate Data Fields)
    }
  }
}</code></pre>
                        <strong>Key Data Fields:</strong>
                        <ul>
                            <li>Crate tier information (10 tiers plus referral)</li>
                            <li>Reward probabilities and amounts</li>
                            <li>Cooldown periods</li>
                            <li>Visual assets</li>
                            <li>User-specific crate availability and cooldowns</li>
                        </ul>
                        <p><strong>Frequency:</strong> Low (likely sent once at connection or when crate system is accessed/updated)</p>
                        <p><strong>Relationship:</strong> Independent system for player rewards outside the main game loop. Details for fields within <code>crates.*</code> and <code>userCrates</code> are in section 4.x (Crate Data Fields).</p>
                    </div>
                </div>
                <!-- Processed Timeline Events will start in Chunk 2 -->

                <h3>3.2 Processed Timeline Events</h3>
                <p>These are the events after reconstruction and processing from the raw WebSocket data, as found in <code>ws_round_timeline.csv</code>.</p>

                <div class="event-card" id="phaseChange-processed-event">
                    <div class="event-title">
                        <h4>3.2.1 phaseChange</h4>
                        <span class="frequency-tag frequency-low">Low Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>Indicates transition in game's primary phase.</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure (CSV):</strong>
                        <pre><code class="language-csv">gameId,phase,timestamp,tick,event_type,event_timestamp,action,actor,price,amount,other_details
"20250429-f14e8e51c9b44c09","active","2025-04-29T07:45:47.990224",1,"phaseChange",,,,,,,</code></pre>
                        <p><strong>Frequency:</strong> Low (only at phase transitions)</p>
                        <p><strong>Relationship:</strong> Derived from changes in <code>gameStateUpdate</code> status fields.</p>
                    </div>
                </div>

                <div class="event-card" id="candle-processed-event">
                    <div class="event-title">
                        <h4>3.2.2 candle</h4>
                        <span class="frequency-tag frequency-medium">Medium Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>Represents a new candlestick bar for the game chart.</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure (CSV):</strong>
                        <pre><code class="language-csv">gameId,phase,timestamp,tick,event_type,event_timestamp,action,actor,price,amount,other_details
"20250429-f14e8e51c9b44c09","active","2025-04-29T07:45:48.245000",1,"candle","2025-04-29T07:45:48.245000",,,1.01,,"{'open': 1.0, 'high': 1.02, 'low': 1.0, 'close': 1.01, 'index': 0, 'volume': 5.5}"</code></pre>
                        <p><strong>Frequency:</strong> Medium (every 5 ticks)</p>
                        <p><strong>Relationship:</strong> Derived from candle data in <code>gameStateUpdate</code>.</p>
                    </div>
                </div>

                <div class="event-card" id="trade-processed-event">
                    <div class="event-title">
                        <h4>3.2.3 trade</h4>
                        <span class="frequency-tag frequency-medium">Medium Frequency</span>
                    </div>
                    <div class="event-description">
                        <p>Represents an individual player transaction (processed view).</p>
                    </div>
                    <div class="event-details">
                        <strong>Event Structure (CSV):</strong>
                        <pre><code class="language-csv">gameId,phase,timestamp,tick,event_type,event_timestamp,action,actor,price,amount,other_details
"20250429-f14e8e51c9b44c09","active","2025-04-29T07:45:49.500000",5,"trade","2025-04-29T07:45:49.500000","buy","Player123",1.05,0.01,</code></pre>
                        <p><strong>Frequency:</strong> Medium (triggered by player actions)</p>
                        <p><strong>Relationship:</strong> Derived from <code>tradeEvent</code> and <code>trades</code> array in <code>gameStateUpdate</code>.</p>
                    </div>
                </div>
            </section>

            <section id="data-fields-reference" class="section">
                <h2>4. Data Fields Reference</h2>

                <h3>4.1 Game State Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>active</code></td>
                            <td>Boolean</td>
                            <td>true, false</td>
                            <td>Whether game is in active phase</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>allowPreRoundBuys</code></td>
                            <td>Boolean</td>
                            <td>true, false</td>
                            <td>Whether pre-round buying is allowed</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>cooldownPaused</code></td>
                            <td>Boolean</td>
                            <td>false</td>
                            <td>Whether cooldown is paused</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>cooldownTimer</code></td>
                            <td>Integer</td>
                            <td>0, 10, 15</td>
                            <td>Seconds remaining in cooldown</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>gameId</code></td>
                            <td>String</td>
                            <td>"20250429-f14e8e51c9b44c09"</td>
                            <td>Unique game identifier</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>gameVersion</code></td>
                            <td>String</td>
                            <td>"v3"</td>
                            <td>Version of game logic</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>price</code></td>
                            <td>Float</td>
                            <td>1.05, 2.4, 0.01</td>
                            <td>Current price multiplier</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>rugged</code></td>
                            <td>Boolean</td>
                            <td>false, true</td>
                            <td>Whether game has ended in rug</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>tickCount</code></td>
                            <td>Integer</td>
                            <td>5, 42, 150</td>
                            <td>Current tick count</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>prngCallCount</code></td>
                            <td>Integer</td>
                            <td>varies</td>
                            <td>Count of random number generator calls</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>tradeCount</code></td>
                            <td>Integer</td>
                            <td>varies</td>
                            <td>Count of trades in current round</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>averageMultiplier</code></td>
                            <td>Float</td>
                            <td>3.42, 4.89</td>
                            <td>Average of recent peak multipliers</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>connectedPlayers</code></td>
                            <td>Integer</td>
                            <td>150, 312</td>
                            <td>Number of connected players</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.2 Candle Data Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>candles</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Historical candle data for current game</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].close</code></td>
                            <td>Float</td>
                            <td>1.05, 0.98</td>
                            <td>Closing price of candle</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].high</code></td>
                            <td>Float</td>
                            <td>1.08, 1.00</td>
                            <td>Highest price during candle period</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].index</code></td>
                            <td>Integer</td>
                            <td>0, 1, 2</td>
                            <td>Sequential identifier for candle</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].low</code></td>
                            <td>Float</td>
                            <td>0.95, 0.85</td>
                            <td>Lowest price during candle period</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].open</code></td>
                            <td>Float</td>
                            <td>1.00, 0.93</td>
                            <td>Opening price of candle</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>candles[].volume</code></td>
                            <td>Float</td>
                            <td>5.5, 12.3</td>
                            <td>Trading volume during candle period</td>
                            <td>candles[]</td>
                            <td><span class="tag tag-partial">⚠️ PARTIALLY VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Currently forming candle</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                         <!-- Assuming currentCandle has same fields as candles[] but for one object -->
                        <tr>
                            <td><code>currentCandle.open</code></td>
                            <td>Float</td>
                            <td>1.15</td>
                            <td>Opening price</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle.high</code></td>
                            <td>Float</td>
                            <td>1.32</td>
                            <td>Current high</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle.low</code></td>
                            <td>Float</td>
                            <td>1.15</td>
                            <td>Current low</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle.close</code></td>
                            <td>Float</td>
                            <td>1.32</td>
                            <td>Current price (acting as close for current)</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle.index</code></td>
                            <td>Integer</td>
                            <td>3</td>
                            <td>Index of current candle</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>currentCandle.volume</code></td>
                            <td>Float</td>
                            <td>4.3</td>
                            <td>Current volume</td>
                            <td>currentCandle</td>
                            <td><span class="tag tag-partial">⚠️ PARTIALLY VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.3 Trade Data Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>trades</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Recent trades in current game</td>
                            <td>gameStateUpdate.data (also tradeEvent.data)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].bonusPortion</code></td>
                            <td>Float</td>
                            <td>0</td>
                            <td>Bonus portion of trade</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].coinAddress</code></td>
                            <td>String</td>
                            <td>"SOL"</td>
                            <td>Address of coin used</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].coinTicker</code></td>
                            <td>String</td>
                            <td>"SOL"</td>
                            <td>Ticker symbol of coin</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].cost</code></td>
                            <td>Float</td>
                            <td>0.005, 0.01</td>
                            <td>Cost of trade</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].isPreRoundBuy</code></td>
                            <td>Boolean</td>
                            <td>true, false</td>
                            <td>Whether trade was pre-round</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].playerId</code></td>
                            <td>String</td>
                            <td>"did..."</td>
                            <td>ID of player making trade</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].price</code></td>
                            <td>Float</td>
                            <td>1, 0.80332</td>
                            <td>Price at execution</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].proceeds</code></td>
                            <td>Float / Null</td>
                            <td>0.021, 0.048, null</td>
                            <td>Proceeds from trade (if sell)</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].qty</code></td>
                            <td>Float</td>
                            <td>0.001, 0.046</td>
                            <td>Quantity traded</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].realPortion</code></td>
                            <td>Float</td>
                            <td>0.001, 0.05</td>
                            <td>Real portion of trade</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].tickIndex</code></td>
                            <td>Integer</td>
                            <td>0, 21, 35</td>
                            <td>Tick at which trade occurred</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].type</code></td>
                            <td>String</td>
                            <td>"buy", "sell"</td>
                            <td>Type of trade</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>trades[].username</code></td>
                            <td>String</td>
                            <td>"Sava", "Anon"</td>
                            <td>Username of trader</td>
                            <td>trades[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.4 Player Data Fields</h3>
                <p>These fields are found in the <code>leaderboard</code> array of <code>gameStateUpdate.data</code>.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>leaderboard</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Array of player data</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].id</code></td>
                            <td>String</td>
                            <td>"did:privy:cNm9xgqof601zrld0mhdy1or92"</td>
                            <td>Unique player identifier</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].username</code></td>
                            <td>String</td>
                            <td>"fatjeeter", "Anon", "Giddy"</td>
                            <td>Display name</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].level</code></td>
                            <td>Integer</td>
                            <td>5, 11, 17</td>
                            <td>Player level/experience</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].pnl</code></td>
                            <td>Float</td>
                            <td>0.0301, -0.0145</td>
                            <td>Profit and loss value in SOL</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].pnlPercent</code></td>
                            <td>Float</td>
                            <td>38.61, -29.12</td>
                            <td>Profit and loss percentage</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].position</code></td>
                            <td>Integer</td>
                            <td>1, 2, 3</td>
                            <td>Position in leaderboard ranking</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].positionQty</code></td>
                            <td>Float</td>
                            <td>0.034, 0.047</td>
                            <td>Quantity of player's current position</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].avgCost</code></td>
                            <td>Float</td>
                            <td>0, 1, 0.726</td>
                            <td>Average entry cost of position</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].totalInvested</code></td>
                            <td>Float</td>
                            <td>0.002, 0.05, 0.14</td>
                            <td>Total amount invested in current game</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].hasActiveTrades</code></td>
                            <td>Boolean</td>
                            <td>true, false</td>
                            <td>Whether player has active trades</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>leaderboard[].selectedCoin</code></td>
                            <td>String/null</td>
                            <td>"SOL", null</td>
                            <td>Selected coin for trading</td>
                            <td>leaderboard[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.5 Historical Data Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>gameHistory</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Data on previous games</td>
                            <td>gameStateUpdate.data</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>gameHistory[].id</code></td>
                            <td>String</td>
                            <td>"20250429-abc123"</td>
                            <td>Game ID</td>
                            <td>gameHistory[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>gameHistory[].peakMultiplier</code></td>
                            <td>Float</td>
                            <td>1.76, 4.23</td>
                            <td>Peak multiplier reached</td>
                            <td>gameHistory[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>gameHistory[].rugged</code></td>
                            <td>Boolean</td>
                            <td>true, false</td>
                            <td>Whether game ended in rug</td>
                            <td>gameHistory[]</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.6 Verification Data Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Verification Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>provablyFair</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Verification information</td>
                            <td>gameStateUpdate.data / Game Result</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>provablyFair.serverSeedHash</code></td>
                            <td>String</td>
                            <td>"43e0...5dd0"</td>
                            <td>Hash of server seed</td>
                            <td>provablyFair</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>provablyFair.version</code></td>
                            <td>String</td>
                            <td>"v3"</td>
                            <td>Version of verification system</td>
                            <td>provablyFair</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>provablyFair.serverSeed</code></td>
                            <td>String</td>
                            <td>"d094...d6fe"</td>
                            <td>Revealed after game ends</td>
                            <td>provablyFair (in game result)</td>
                            <td><span class="tag tag-verified">✅ VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>4.7 Crate Data Fields</h3>
                <p>These fields are found in the <code>data</code> object of <code>crateInfo</code> events and its sub-objects.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Example Values</th>
                            <th>Description</th>
                            <th>Parent Object</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>crates</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Container for all available crate type definitions</td>
                            <td>crateInfo.data</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.tier0</code> to <code>crates.tier9</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Crate information for a specific tier (e.g., tier0 for Iron Crate)</td>
                            <td>crates</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.referral</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Referral crate information</td>
                            <td>crates</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.name</code></td>
                            <td>String</td>
                            <td>"Iron Crate", "Diamond Crate"</td>
                            <td>Display name of the crate tier</td>
                            <td>crates.tierX / crates.referral</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.cooldown</code></td>
                            <td>String</td>
                            <td>"1h", "4d"</td>
                            <td>Cooldown period after claiming this crate type</td>
                            <td>crates.tierX / crates.referral</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.rewards</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Array of possible reward tiers/probabilities for this crate type</td>
                            <td>crates.tierX / crates.referral</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.rewards[].probability</code></td>
                            <td>Float</td>
                            <td>0.2918, 0.05</td>
                            <td>Probability of receiving this specific reward from the crate</td>
                            <td>crates.*.rewards[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.rewards[].value</code></td>
                            <td>Float</td>
                            <td>0, 0.0001, 1.5</td>
                            <td>Reward value in SOL (or other currency/item)</td>
                            <td>crates.*.rewards[]</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>crates.*.image</code></td>
                            <td>String</td>
                            <td>"https://assets.rugs.fun/crates/iron.png"</td>
                            <td>URL to the image for this crate type</td>
                            <td>crates.tierX / crates.referral</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>userCrates</code></td>
                            <td>Object</td>
                            <td>{...}</td>
                            <td>Container for the current user's crate status</td>
                            <td>crateInfo.data</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>userCrates.available</code></td>
                            <td>Array</td>
                            <td>["tier0", "tier1"]</td>
                            <td>Array of crate tiers currently available for the user to claim</td>
                            <td>userCrates</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>userCrates.cooldowns</code></td>
                            <td>Object</td>
                            <td>{"tier0": 3600000, ...}</td>
                            <td>Map of crate tier to remaining cooldown in milliseconds</td>
                            <td>userCrates</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                        <tr>
                            <td><code>userCrates.claimHistory</code></td>
                            <td>Array</td>
                            <td>[...]</td>
                            <td>Recent crate claim history for the user</td>
                            <td>userCrates</td>
                            <td><span class="tag tag-verified">VERIFIED</span></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="event-relationships" class="section">
                <h2>5. Event Relationships</h2>
                <h3>5.1 Event Flow</h3>
                <pre><code>Game Start
  └── gameStateUpdate (active: false, allowPreRoundBuys: true)
      └── phaseChange (presale)
          ├── Trade events (buy only)
          └── gameStateUpdate (active: true)
              └── phaseChange (active)
                  ├── Candle events (every 5 ticks)
                  ├── Trade events (buy/sell)
                  └── gameStateUpdate (active: false, rugged: true/false)
                      └── phaseChange (settlement)
                          └── gameStateUpdate (cooldownTimer: X)
                              └── phaseChange (cooldown)
                                  └── Game Start (new gameId)</code></pre>
                <h3>5.2 Data Relationships</h3>
                <ul>
                    <li><strong>Candles and Ticks:</strong> Each candle represents 5 ticks of price data (<code>TICKS_PER_CANDLE</code>).</li>
                    <li><strong>Trades and Candles:</strong> Trades occur at specific ticks and are reflected in candle volume.</li>
                    <li><strong>Game History and Verification:</strong> Each game's outcome is linked to its server seed.</li>
                    <li><strong>Player Positions and Trades:</strong> A player's position is the sum of their active trades.</li>
                </ul>
                <h3>5.3 Reward Systems</h3>
                <p>The game includes multiple interconnected reward systems outside the main gameplay loop:</p>
                <ul>
                    <li><strong>Crate System:</strong> Tiered rewards with cooldowns (via <code>crateInfo</code> event).</li>
                    <li><strong>XP System:</strong> 1 XP per valid bet of 0.001 SOL, scaled by duration.</li>
                    <li><strong>Level System:</strong> Player levels visible in leaderboard data.</li>
                    <li><strong>Referral System:</strong> Special crates for referrals that reach level 20.</li>
                </ul>
            </section>

            <section id="verification-status" class="section">
                <h2>6. Verification Status</h2>
                <h3>6.1 Fully Verified Fields (✅)</h3>
                <p>All fields marked with ✅ in the tables above have been fully verified through direct observation and data analysis.</p>
                <h3>6.2 Partially Verified (⚠️)</h3>
                <p>The following items have been partially verified but require additional confirmation:</p>
                <ul>
                    <li><strong>Server Seed Reveal:</strong> Need to confirm exactly when/how the full seed is revealed for all game outcomes.</li>
                    <li><strong>Maximum Game Duration:</strong> Need to observe a game reach the 5000 tick maximum.</li>
                    <li><strong><code>candles[].volume</code> / <code>currentCandle.volume</code>:</strong> Exact calculation and inclusion of all trade types needs further validation.</li>
                </ul>
                <h3>6.3 Verification Plan</h3>
                <p>To complete verification of all fields:</p>
                <ul>
                    <li><strong>Extended Observation:</strong>
                        <ul>
                            <li>Monitor 100+ complete game cycles.</li>
                            <li>Focus on capturing rare events (God Candles, extreme durations).</li>
                        </ul>
                    </li>
                    <li><strong>Statistical Analysis:</strong>
                        <ul>
                            <li>Compare observed vs. documented probabilities.</li>
                            <li>Verify price generation algorithm against actual outcomes.</li>
                        </ul>
                    </li>
                    <li><strong>Edge Case Testing:</strong>
                        <ul>
                            <li>Test connection stability and recovery.</li>
                            <li>Observe behavior during unusual market conditions.</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section id="example-payloads" class="section">
                <h2>7. Example Payloads</h2>

                <h3>7.0 God Candle Events (Verified)</h3>
                <p>From analysis of 6 rounds with 263 crash events:</p>
                <p>God candle events:</p>
                <pre><code class="language-json">- {'timestamp': '2025-04-29T01:47:18.982458', 'from': 0.007695034507758213, 'to': 1}
- {'timestamp': '2025-04-29T01:48:35.614726', 'from': 0.009766463012427883, 'to': 1}
- {'timestamp': '2025-04-29T02:39:43.459147', 'from': 0.01814971594758776, 'to': 1}
- {'timestamp': '2025-04-29T02:40:43.255556', 'from': 0.014889449055213883, 'to': 1}
- {'timestamp': '2025-04-29T02:41:04.422642', 'from': 0.020000000000000018, 'to': 1}</code></pre>
                <p><strong>Key observations:</strong></p>
                <ul>
                    <li>All detected "God Candles" happened during active gameplay after significant price drops.</li>
                    <li>These events technically qualify as >10x price increases (from 0.007-0.02 to 1.0).</li>
                    <li>This approach allows the game to claim higher God Candle frequency while maintaining technical compliance with advertised mechanics.</li>
                    <li>True random God Candles that occur from normal price levels may be much rarer than suggested.</li>
                </ul>

                <h3>7.1 gameStateUpdate Example</h3>
                <pre><code class="language-json">{
  "type": "gameStateUpdate",
  "data": {
    "active": true,
    "gameId": "20250429-f14e8e51c9b44c09",
    "tickCount": 42,
    "price": 1.1233869588238743,
    "rugged": false,
    "prngCallCount": 654,
    "cooldownTimer": 0,
    "averageMultiplier": 3.75,
    "connectedPlayers": 178,
    "candles": [
      {
        "open": 1.0,
        "high": 1.05,
        "low": 0.98,
        "close": 1.03,
        "index": 0,
        "volume": 7.5
      },
      {
        "open": 1.03,
        "high": 1.12,
        "low": 1.01,
        "close": 1.09,
        "index": 1,
        "volume": 3.2
      }
    ],
    "currentCandle": {
      "open": 1.09,
      "high": 1.12,
      "low": 1.08,
      "close": 1.12,
      "index": 2,
      "volume": 2.1
    },
    "trades": [
      {
        "playerId": "did:privy:abc123",
        "username": "Trader42",
        "type": "buy",
        "price": 1.0,
        "qty": 0.05,
        "tickIndex": 0,
        "isPreRoundBuy": true,
        "cost": 0.05,
        "coinTicker": "SOL"
      },
      {
        "playerId": "did:privy:def456",
        "username": "CryptoWhale",
        "type": "sell",
        "price": 1.1,
        "qty": 0.02,
        "tickIndex": 40,
        "isPreRoundBuy": false,
        "proceeds": 0.022,
        "coinTicker": "SOL"
      }
    ],
    "leaderboard": [
      {
        "id": "did:privy:ghi789",
        "username": "Diamond",
        "level": 15,
        "pnl": 0.0321,
        "pnlPercent": 42.8,
        "position": 1,
        "positionQty": 0.075,
        "avgCost": 1.0,
        "totalInvested": 0.075
      }
    ],
    "gameHistory": [
      {
        "id": "20250429-e5a24c51b3a99178",
        "peakMultiplier": 2.45,
        "rugged": true
      }
    ],
    "provablyFair": {
      "serverSeedHash": "1d78eeadf6ecf59ca0d8503d493eff0c2180be98bff95ad31a2bcb7ebfc4b43f",
      "version": "v3"
    },
    "BIG_MOVE_CHANCE": 0.125,
    "BIG_MOVE_MAX": 0.25,
    "BIG_MOVE_MIN": 0.15,
    "DRIFT_MAX": 0.03,
    "DRIFT_MIN": -0.02,
    "MAX_BET_SOL": 5,
    "MIN_VALID_TICKS": 20,
    "RUG_PROB": 0.005,
    "TICKS_PER_CANDLE": 5,
    "TICK_MS": 250,
    "TRADE_FEE": 0
  }
}</code></pre>

                <h3>7.2 tradeEvent Example</h3>
                <pre><code class="language-json">{
  "type": "tradeEvent",
  "data": {
    "playerId": "did:privy:jkl012",
    "username": "Hodler",
    "type": "buy",
    "price": 1.25,
    "qty": 0.01,
    "tickIndex": 47,
    "isPreRoundBuy": false,
    "cost": 0.0125,
    "coinTicker": "SOL"
  }
}</code></pre>

                <h3>7.3 Processed phaseChange Example (CSV)</h3>
                <pre><code class="language-csv">gameId,phase,timestamp,tick,event_type,event_timestamp,action,actor,price,amount,other_details
"20250429-f14e8e51c9b44c09","active","2025-04-29T07:45:47.990224",1,"phaseChange",,,,,,,</code></pre>

                <h3>7.4 Processed candle Example (CSV)</h3>
                <pre><code class="language-csv">gameId,phase,timestamp,tick,event_type,event_timestamp,action,actor,price,amount,other_details
"20250429-f14e8e51c9b44c09","active","2025-04-29T07:45:48.245000",1,"candle","2025-04-29T07:45:48.245000",,,1.01,,"{'open': 1.0, 'high': 1.02, 'low': 1.0, 'close': 1.01, 'index': 0, 'volume': 5.5}"</code></pre>
                
                <h3>7.5 Command Execution Examples</h3>
                <p>This section covers how to execute commands via the WebSocket connection and their responses.</p>
                <h4>Basic Command Structure (Send)</h4>
                <pre><code class="language-json">{
  "type": "command",
  "command": "COMMAND_NAME",
  "parameters": {
    // Command-specific parameters
  },
  "requestId": "client-generated-id"
}</code></pre>
                <h4>Standard Commands Table</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Command</th>
                            <th>Parameters</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>placeBuy</code></td>
                            <td><code>amount</code>, <code>coin</code>, <code>autoCashout</code> (optional)</td>
                            <td>Place a buy order</td>
                        </tr>
                        <tr>
                            <td><code>placeSell</code></td>
                            <td><code>percentage</code></td>
                            <td>Sell a percentage of position</td>
                        </tr>
                        <tr>
                            <td><code>setAutoCashout</code></td>
                            <td><code>multiplier</code></td>
                            <td>Set auto-cashout level</td>
                        </tr>
                        <tr>
                            <td><code>cancelAutoCashout</code></td>
                            <td>none</td>
                            <td>Cancel auto-cashout</td>
                        </tr>
                        <tr>
                            <td><code>getGameHistory</code></td>
                            <td><code>count</code>, <code>includeCandles</code> (optional)</td>
                            <td>Get recent game history</td>
                        </tr>
                        <tr>
                            <td><code>sendChatMessage</code></td>
                            <td><code>message</code>, <code>channel</code></td>
                            <td>Send a chat message</td>
                        </tr>
                    </tbody>
                </table>
                <div class="toggle-btn" onclick="toggleSection('command-execution-example-full')">View Complete Command Execution Flow Example</div>
                <pre id="command-execution-example-full" class="hidden"><button class="copy-btn" onclick="copyToClipboard('command-execution-example-full-content')">Copy</button><code id="command-execution-example-full-content" class="language-json">// 1. Send command
{
  "type": "command",
  "command": "placeBuy",
  "parameters": {
    "amount": 0.025,
    "coin": "SOL",
    "autoCashout": 1.5
  },
  "requestId": "buy-1593574682"
}

// 2. Receive response
{
  "type": "commandResponse",
  "requestId": "buy-1593574682",
  "success": true,
  "data": {
    "tradeId": "trade_o5p6q7r8s9t0u1v2w3x4",
    "executed": {
      "amount": 0.025,
      "price": 1.0,
      "timestamp": 1715688885732
    },
    "autoCashout": 1.5
  }
}

// 3. Receive game state update with new position
{
  "type": "gameStateUpdate",
  "data": {
    // Updated game state including your new position in leaderboard and trades array
  }
}

// 4. Receive specific trade event (optional, may also be in gameStateUpdate)
{
  "type": "tradeEvent",
  "data": {
    "playerId": "your-player-id",
    "username": "YourUsername",
    "type": "buy",
    "price": 1.0,
    "qty": 0.025,
    "tickIndex": 42, // Example tick
    "isPreRoundBuy": false,
    "cost": 0.025,
    "coinTicker": "SOL"
  }
}</code></pre>
                <h4>Rate Limit Error Example</h4>
                 <div class="toggle-btn" onclick="toggleSection('rate-limit-error-example')">View Rate Limit Error Example</div>
                <pre id="rate-limit-error-example" class="hidden"><button class="copy-btn" onclick="copyToClipboard('rate-limit-error-example-content')">Copy</button><code id="rate-limit-error-example-content" class="language-json">{
  "type": "commandResponse",
  "requestId": "buy-7777777",
  "success": false,
  "error": {
    "code": "ERROR_RATE_LIMIT",
    "message": "Rate limit exceeded for placeBuy command",
    "details": {
      "retryAfter": 5000, // milliseconds
      "limitType": "commandType",
      "command": "placeBuy"
    }
  }
}</code></pre>

                <h3>7.6 Server Seed Reveal Example (Game Result)</h3>
                <pre><code class="language-json">{
  "id": "20250429-4a2cf7ec581746f8",
  "candles": [
    {"open": 1, "high": 1, "low": 0.6176019684596846, "close": 0.6176019684596846, "index": 0},
    {"open": 0.6176019684596846, "high": 0.6176019684596846, "low": 0.01234629903326671, "close": 0.01234629903326671, "index": 1}
  ],
  "peakMultiplier": 1,
  "rugged": true,
  "timestamp": 1745905436395,
  "dateTime": "2025-04-29T05:43:56.395Z",
  "globalTrades": [],
  "provablyFair": {
    "serverSeed": "d0948e6641ef9a09907fc9011527dbe818bdd6db82de2ae4f29479a58966d6fe",
    "serverSeedHash": "43e028ff348e68dcad468fddc1103ac25ff73137a731889452c0d2bcac3f5dd0",
    "version": "v3"
  },
  "version": "v3"
}</code></pre>
                <p><strong>Key observations:</strong></p>
                <ul>
                    <li>Server seed is revealed in the <code>provablyFair.serverSeed</code> field after game completion.</li>
                    <li>The hash of this seed matches the previously published <code>serverSeedHash</code>.</li>
                    <li>Both the seed and its hash are included in the final game state data (often retrieved via a history endpoint or a final game summary event not detailed here).</li>
                </ul>
                <h3>7.7 Connection Lifecycle Examples</h3>
                <div class="toggle-btn" onclick="toggleSection('connection-lifecycle-example-full')">View Connection Lifecycle Example</div>
               <pre id="connection-lifecycle-example-full" class="hidden"><button class="copy-btn" onclick="copyToClipboard('connection-lifecycle-example-full-content')">Copy</button><code id="connection-lifecycle-example-full-content" class="language-json">// 1. Initial Connection Response (Example)
{
"type": "connect", // Or similar initial handshake message
"data": {
"sessionId": "sess_k5l6m7n8o9p0q1r2s3t4",
"timestamp": 1715688436395,
"connectionId": "conn_a1b2c3d4e5f6g7h8i9j0",
"version": "3.7.2"
}
}

// 2. Initial Game State (after connection/auth)
{
"type": "gameStateUpdate",
"data": {
// Full game state as per section 7.1
}
}

// 3. Heartbeat (Conceptual - actual pings/pongs might be raw '2' and '3')
// Server sends: 2 (ping)
// Client responds: 3 (pong)
// (Typically every 25 seconds)

// 4. Disconnection Event (Example)
{
"type": "disconnect", // Or similar event from server/client library
"data": {
"reason": "client_closed" / "server_shutdown" / "network_error",
"timestamp": 1715688743128,
"sessionId": "sess_k5l6m7n8o9p0q1r2s3t4",
"reconnectAllowed": true
}
}

// 5. Reconnection Event (Example)
{
"type": "reconnect", // Or similar event from server/client library
"data": {
"sessionId": "sess_k5l6m7n8o9p0q1r2s3t4",
"previousConnectionId": "conn_a1b2c3d4e5f6g7h8i9j0",
"newConnectionId": "conn_u5v6w7x8y9z0a1b2c3d4",
"timestamp": 1715688750349,
"attemptNumber": 1
}
}
</code></pre>
           </section> <!-- Closes example-payloads section -->

           <script>
               function toggleSection(id) {
                   const section = document.getElementById(id);
                   if (section) {
                       if (section.classList.contains('hidden')) {
                           section.classList.remove('hidden');
                       } else {
                           section.classList.add('hidden');
                       }
                   }
               }
               
               function copyToClipboard(id) {
                   const codeElement = document.getElementById(id);
                   if (!codeElement) return;
                   
                   const textToCopy = codeElement.textContent;
                   navigator.clipboard.writeText(textToCopy)
                       .then(() => {
                           const allButtons = document.querySelectorAll('.copy-btn');
                           let clickedButton = null;
                           // Try to find the button associated with this specific code block id
                           const preElement = codeElement.closest('pre');
                           if (preElement) {
                               clickedButton = preElement.querySelector('.copy-btn');
                           }

                           if (clickedButton) {
                               const originalText = clickedButton.textContent;
                               clickedButton.textContent = 'Copied!';
                               setTimeout(() => {
                                   clickedButton.textContent = originalText;
                               }, 2000);
                           }
                       })
                       .catch(err => {
                           console.error('Failed to copy: ', err);
                       });
               }
               
               function scrollToSection(id) {
                   const section = document.getElementById(id);
                   if (section) {
                       section.scrollIntoView({ behavior: 'smooth' });
                       
                       const allNavItems = document.querySelectorAll('.sidebar .nav-item');
                       allNavItems.forEach(item => item.classList.remove('active'));
                       
                       // Try to find the nav item that specifically calls scrollToSection with this id
                       const navItem = document.querySelector(`.sidebar .nav-item[onclick*="scrollToSection('${id}')"]`);
                       if (navItem) {
                           navItem.classList.add('active');
                       }
                   }
               }
               
               document.addEventListener('DOMContentLoaded', function() {
                   const searchInput = document.getElementById('search-input');
                   if (searchInput) {
                       searchInput.addEventListener('input', function(e) {
                           const searchTerm = e.target.value.toLowerCase();
                           const allContentSections = document.querySelectorAll('.content .section > h2, .content .section > h3, .content .section > h4, .content .section > p, .content .section td, .content .section li');
                           const allCodeBlocks = document.querySelectorAll('pre code');
                           let firstMatchElement = null;

                           if (searchTerm.length < 2) return;

                           // Search text content first
                           for (const el of allContentSections) {
                               if (el.textContent.toLowerCase().includes(searchTerm)) {
                                   firstMatchElement = el.closest('.section') || el;
                                   break;
                               }
                           }

                           // If no text match, search code blocks
                           if (!firstMatchElement) {
                               for (const codeBlock of allCodeBlocks) {
                                   if (codeBlock.textContent.toLowerCase().includes(searchTerm)) {
                                       firstMatchElement = codeBlock.closest('.section') || codeBlock.closest('pre') || codeBlock;
                                       if (firstMatchElement.closest('pre') && firstMatchElement.closest('pre').classList.contains('hidden')) {
                                          firstMatchElement.closest('pre').classList.remove('hidden');
                                       }
                                       break;
                                   }
                               }
                           }

                           if (firstMatchElement) {
                               firstMatchElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                           }
                       });
                   }

                   if (window.location.hash) {
                       const hashId = window.location.hash.substring(1);
                       const targetSection = document.getElementById(hashId);
                       if (targetSection && targetSection.classList.contains('hidden') && targetSection.tagName === 'PRE') {
                           targetSection.classList.remove('hidden');
                       }
                       scrollToSection(hashId);
                   } else {
                       const firstNavItem = document.querySelector('.sidebar .nav-item');
                       if (firstNavItem) {
                           firstNavItem.classList.add('active');
                       }
                   }
               });
           </script>
       </div> <!-- Closes .content -->
   </div> <!-- Closes .container -->
</body>
</html> 